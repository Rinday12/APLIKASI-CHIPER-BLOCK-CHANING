<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KRIPTOGRAFI DEKRIPSI</title>

    <!--css-->
    <link rel="stylesheet" href="style.css">

    <!--google fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!--ion icons-->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</head>
<body>
    <header style="color: #643843;">
        <div class="bar">
            <a href="enkripsi.html">Enkripsi</a>
            <a href="dekripsi.html">Dekripsi</a>
            <a href="bantuan.html">Bantuan</a>
        </div>
    </header>
    <div class="container">
        <form form id="decryptForm" onsubmit="decryptCBC(event)">
            <div class="data">
                <ion-icon name="key-outline"></ion-icon>
                <input type="text" id="encryptKey" placeholder="Key">
            </div>
            <div class="dataholder">
                <div class="data">
                    <ion-icon name="text-outline"></ion-icon>
                    <div class="calculate">
                        <textarea id="chipertext" cols="60" rows="10" placeholder="Chipertext"></textarea>
                        <div class="cal">
                            <input type="text" id="mediaSize" placeholder="Besar Media" style="padding: 2%; border-radius: 0; background-color: #FEF2F4; border: 0; margin-top: 5%;">
                        </div>
                    </div>
                </div>
                <div class="data" style="margin-left: 10%;">
                    <ion-icon name="text-outline"></ion-icon>
                    <div class="calculate">
                        <textarea  id="hasilTes" cols="60" rows="10" placeholder="Plaintext"></textarea>
                        <div class="cal">
                            <input type="text"  id="time" placeholder="Waktu" style="padding: 2%; border-radius: 0; background-color: #FEF2F4; border: 0; margin-top: 5%;">
                        </div>
                    </div>
                </div>
            </div>
            <input type="submit" value="PROSES">
        </form>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script>
        function decryptCBC(event) {
            const start = new Date(); // Waktu mulai
            event.preventDefault();

        const key = document.getElementById('encryptKey').value;
        const chipertext = document.getElementById('chipertext').value;

        const iv = CryptoJS.enc.Hex.parse('11110000');

        const decrypted = CryptoJS.AES.decrypt(chipertext, key, {
  iv: iv,
  mode: CryptoJS.mode.CBC,
});


const decryptedPlaintext = decrypted.toString(CryptoJS.enc.Utf8);


            const end = new Date(); // Waktu selesai
            const difference = (end - start) / 1000;
            document.getElementById('hasilTes').value = decryptedPlaintext;
                document.getElementById('mediaSize').value = chipertext.length;
                document.getElementById('time').value = difference;


}
    </script>
</body>
</html>